<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ù†ØµØ© Ø¹Ù…Ø§Ø¯ ÙƒØ§Ø¸Ù… Ù„Ù„ØªØ¯Ø±ÙŠØ¨ ÙˆØ§Ù„ØªØ·ÙˆÙŠØ± | MARC21 & RDA</title>

<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>
:root { --primary:#2c3e50; --accent:#4a90e2; --bg:#f4f7f9; }
body { font-family: 'Segoe UI', Tahoma; background:var(--bg); padding:20px; }
.container { max-width:1200px; margin:auto; background:white; padding:30px; border-radius:15px; }
.training-modes { display:flex; gap:10px; justify-content:center; margin-bottom:20px; }
.btn-sample { border:1px solid var(--primary); background:#fff; padding:8px 15px; border-radius:20px; cursor:pointer; }
.grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(300px,1fr)); gap:15px; }
.field-group { border:1px solid #ddd; padding:10px; border-radius:8px; }
label { font-size:0.8em; font-weight:bold; display:flex; justify-content:space-between; }
input { width:100%; padding:6px; margin-top:5px; }
.help-q { color:var(--accent); text-decoration:none; border:1px solid var(--accent); border-radius:50%; width:18px; height:18px; display:inline-flex; justify-content:center; }
.add-btn { background:var(--accent); color:white; border:none; border-radius:50%; width:20px; cursor:pointer; }
.section-h { grid-column:1/-1; background:var(--primary); color:white; padding:8px; border-radius:5px; margin-top:15px; }
.output-box { background:#1e272e; color:#00d8d6; padding:20px; border-radius:10px; margin-top:30px; }
.actions { display:flex; justify-content:center; gap:10px; margin:20px 0; }
.main-btn { padding:10px 20px; border:none; border-radius:5px; color:white; cursor:pointer; }
</style>
</head>

<body>
<div class="container">
<h1 style="text-align:center">ğŸ“š Ù…Ù†ØµØ© Ø¹Ù…Ø§Ø¯ ÙƒØ§Ø¸Ù… Ù„Ù„ØªØ¯Ø±ÙŠØ¨ ÙˆØ§Ù„ØªØ·ÙˆÙŠØ±</h1>

<div class="training-modes">
<button class="btn-sample" onclick="loadSample('book')">ÙƒØªØ§Ø¨</button>
<button class="btn-sample" onclick="loadSample('thesis')">Ø£Ø·Ø±ÙˆØ­Ø©</button>
<button class="btn-sample" onclick="loadSample('electronic')">Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</button>
<button class="btn-sample" onclick="clearForm()">Ù…Ø³Ø­</button>
</div>

<form id="marcForm">
<div class="grid">

<div class="section-h">Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>

<div class="field-group repeatable" data-tag="100">
<label>100 Ù…Ø¤Ù„Ù
<span>
<a href="https://www.bibalex.org/als/marcA/homepage/home.html" target="_blank" class="help-q">ØŸ</a>
<button type="button" class="add-btn" onclick="addField(this)">+</button>
</span>
</label>
<input>
</div>

<div class="field-group repeatable" data-tag="110">
<label>110 Ù‡ÙŠØ¦Ø©
<span>
<a href="https://www.bibalex.org/als/marcA/homepage/home.html" target="_blank" class="help-q">ØŸ</a>
<button type="button" class="add-btn" onclick="addField(this)">+</button>
</span>
</label>
<input>
</div>

<div class="field-group repeatable" data-tag="111">
<label>111 Ù…Ø¤ØªÙ…Ø±
<span>
<a href="https://www.bibalex.org/als/marcA/homepage/home.html" target="_blank" class="help-q">ØŸ</a>
<button type="button" class="add-btn" onclick="addField(this)">+</button>
</span>
</label>
<input>
</div>

<div class="section-h">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</div>

<div class="field-group repeatable" data-tag="245">
<label>245 Ø¹Ù†ÙˆØ§Ù†
<span>
<a href="https://www.bibalex.org/als/marcA/homepage/home.html" target="_blank" class="help-q">ØŸ</a>
<button type="button" class="add-btn" onclick="addField(this)">+</button>
</span>
</label>
<input>
</div>

<div class="field-group repeatable" data-tag="246">
<label>246 Ø¹Ù†ÙˆØ§Ù† Ø¨Ø¯ÙŠÙ„
<span>
<a href="https://www.bibalex.org/als/marcA/homepage/home.html" target="_blank" class="help-q">ØŸ</a>
<button type="button" class="add-btn" onclick="addField(this)">+</button>
</span>
</label>
<input>
</div>

<div class="section-h">Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹Ø§Øª</div>

<div class="field-group repeatable" data-tag="600">
<label>600 Ø´Ø®Øµ
<span>
<a href="https://www.bibalex.org/als/marcA/homepage/home.html" target="_blank" class="help-q">ØŸ</a>
<button type="button" class="add-btn" onclick="addField(this)">+</button>
</span>
</label>
<input>
</div>

<div class="field-group repeatable" data-tag="610">
<label>610 Ù‡ÙŠØ¦Ø©
<span>
<a href="https://www.bibalex.org/als/marcA/homepage/home.html" target="_blank" class="help-q">ØŸ</a>
<button type="button" class="add-btn" onclick="addField(this)">+</button>
</span>
</label>
<input>
</div>

<div class="field-group repeatable" data-tag="611">
<label>611 Ù…Ø¤ØªÙ…Ø±
<span>
<a href="https://www.bibalex.org/als/marcA/homepage/home.html" target="_blank" class="help-q">ØŸ</a>
<button type="button" class="add-btn" onclick="addField(this)">+</button>
</span>
</label>
<input>
</div>

<div class="field-group repeatable" data-tag="650">
<label>650 Ù…ÙˆØ¶ÙˆØ¹ Ø¹Ø§Ù…
<span>
<a href="https://www.bibalex.org/als/marcA/homepage/home.html" target="_blank" class="help-q">ØŸ</a>
<button type="button" class="add-btn" onclick="addField(this)">+</button>
</span>
</label>
<input>
</div>

<div class="section-h">Ù…Ø¯Ø§Ø®Ù„ Ø¥Ø¶Ø§ÙÙŠØ©</div>

<div class="field-group repeatable" data-tag="710">
<label>710 Ù‡ÙŠØ¦Ø© Ø¥Ø¶Ø§ÙÙŠØ©
<span>
<a href="https://www.bibalex.org/als/marcA/homepage/home.html" target="_blank" class="help-q">ØŸ</a>
<button type="button" class="add-btn" onclick="addField(this)">+</button>
</span>
</label>
<input>
</div>

<div class="field-group repeatable" data-tag="711">
<label>711 Ù…Ø¤ØªÙ…Ø± Ø¥Ø¶Ø§ÙÙŠ
<span>
<a href="https://www.bibalex.org/als/marcA/homepage/home.html" target="_blank" class="help-q">ØŸ</a>
<button type="button" class="add-btn" onclick="addField(this)">+</button>
</span>
</label>
<input>
</div>

<div class="field-group repeatable" data-tag="130">
<label>130 Ø¹Ù†ÙˆØ§Ù† Ù…ÙˆØ­Ø¯
<span>
<a href="https://www.bibalex.org/als/marcA/homepage/home.html" target="_blank" class="help-q">ØŸ</a>
<button type="button" class="add-btn" onclick="addField(this)">+</button>
</span>
</label>
<input>
</div>

</div>
</form>

<div class="actions">
<button onclick="updateDisplay()" class="main-btn" style="background:#4a90e2">ØªØ­Ø¯ÙŠØ«</button>
<button onclick="exportExcel()" class="main-btn" style="background:#27ae60">Excel</button>
</div>

<div class="output-box">
<pre id="marcDisplay">LDR 00000nam a2200000 i 4500</pre>
</div>

</div>

<script>
function addField(btn){
 const group=btn.closest('.field-group');
 const clone=group.cloneNode(true);
 clone.querySelector('input').value='';
 group.parentNode.insertBefore(clone,group.nextSibling);
}

function clearForm(){
 document.querySelectorAll('input').forEach(i=>i.value='');
 updateDisplay();
}

function updateDisplay(){
 let text="LDR 00000nam a2200000 i 4500\n";
 document.querySelectorAll('.field-group').forEach(g=>{
  let tag=g.dataset.tag;
  let val=g.querySelector('input').value;
  if(val) text+=`${tag} ## $a ${val}\n`;
 });
 document.getElementById('marcDisplay').innerText=text;
}

function exportExcel(){
 let rows=[["Tag","Data"]];
 document.querySelectorAll('.field-group').forEach(g=>{
  let tag=g.dataset.tag;
  let val=g.querySelector('input').value;
  if(val) rows.push([tag,val]);
 });
 let ws=XLSX.utils.aoa_to_sheet(rows);
 let wb=XLSX.utils.book_new();
 XLSX.utils.book_append_sheet(wb,ws,"MARC");
 XLSX.writeFile(wb,"Emad_Kazem_MARC.xlsx");
}

function loadSample(type){
 clearForm();
 const samples={
  book:{100:"Ø§Ù„Ø³Ø¹Ø¯ÙŠØŒ Ø¹Ù…Ø§Ø¯ ÙƒØ§Ø¸Ù…",245:"Ø£Ø³Ø§Ø³ÙŠØ§Øª Ø§Ù„ÙÙ‡Ø±Ø³Ø©",650:"MARC21"},
  thesis:{100:"Ø§Ù„ØªÙ…ÙŠÙ…ÙŠØŒ Ø£Ø­Ù…Ø¯",245:"ØªØ·ÙˆÙŠØ± Ù†Ø¸Ù… Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª",502:"Ø£Ø·Ø±ÙˆØ­Ø©"},
  electronic:{245:"Ù…Ø¬Ù„Ø© Ø±Ù‚Ù…ÙŠØ©",650:"Ù…ØµØ§Ø¯Ø± Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©"}
 };
 Object.keys(samples[type]||{}).forEach(tag=>{
  document.querySelector(`[data-tag="${tag}"] input`).value=samples[type][tag];
 });
 updateDisplay();
}
</script>
</body>
</html>
