<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© Ø¹Ù…Ø§Ø¯ ÙƒØ§Ø¸Ù… Ø§Ù„Ø´Ø§Ù…Ù„Ø© | MARC21 & RDA</title>
    
    <!-- Ù…ÙƒØªØ¨Ø© ØªØµØ¯ÙŠØ± Excel -->
    <script src="https://cdn.jsdelivr.net"></script>

    <style>
        :root { 
            --primary: #2563eb; --secondary: #64748b; 
            --success: #16a34a; --bg: #f8fafc; 
            --card-bg: #ffffff; --text: #1e293b;
        }
        body { font-family: 'Segoe UI', Tahoma, Arial; background: var(--bg); color: var(--text); padding: 20px; line-height: 1.6; }
        .container { max-width: 1200px; margin: auto; }
        
        /* Ø§Ù„Ø±Ø£Ø³ */
        .header { text-align: center; margin-bottom: 30px; background: white; padding: 25px; border-radius: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .header h1 { margin: 0; color: var(--primary); }
        
        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø¬Ø§Ù‡Ø²Ø© */
        .training-modes { display: flex; flex-wrap: wrap; gap: 12px; justify-content: center; margin-bottom: 30px; }
        .btn-mode { padding: 10px 22px; border: 2px solid var(--primary); background: white; color: var(--primary); border-radius: 12px; cursor: pointer; font-weight: 600; transition: 0.3s; }
        .btn-mode:hover { background: var(--primary); color: white; }
        .btn-clear { border-color: #ef4444; color: #ef4444; }
        .btn-clear:hover { background: #ef4444; color: white; }

        /* Ø´Ø¨ÙƒØ© Ø§Ù„Ø­Ù‚ÙˆÙ„ */
        .marc-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; }
        .card { background: var(--card-bg); padding: 22px; border-radius: 18px; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); border: 1px solid #e2e8f0; }
        .card-title { background: #f8fafc; margin: -22px -22px 20px -22px; padding: 15px 22px; border-radius: 18px 18px 0 0; font-size: 0.95rem; font-weight: bold; color: var(--primary); border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center; }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø­Ù‚Ù„ */
        .field-row { margin-bottom: 18px; }
        .label-box { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
        label { font-size: 0.85rem; font-weight: 700; color: var(--secondary); }
        .tag-num { background: #dbeafe; color: #1e40af; padding: 2px 8px; border-radius: 6px; font-family: monospace; margin-left: 8px; font-weight: bold; }
        
        /* Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© */
        .help-link { 
            background: #f1f5f9; color: var(--primary); 
            width: 24px; height: 24px; border-radius: 50%; 
            display: inline-flex; align-items: center; justify-content: center; 
            text-decoration: none; font-size: 13px; font-weight: bold; border: 1px solid #e2e8f0;
        }
        .help-link:hover { background: var(--primary); color: white; transform: scale(1.1); }

        input { width: 100%; padding: 11px; border: 1px solid #cbd5e1; border-radius: 10px; box-sizing: border-box; font-size: 0.95rem; }
        input:focus { border-color: var(--primary); outline: none; box-shadow: 0 0 0 4px rgba(37,99,235,0.1); }
        
        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… */
        .actions { text-align: center; margin: 40px 0; display: flex; justify-content: center; gap: 20px; }
        .btn-main { padding: 15px 45px; border: none; border-radius: 14px; color: white; cursor: pointer; font-weight: 700; font-size: 1.1rem; }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª */
        .output-container { background: #0f172a; color: #38bdf8; padding: 25px; border-radius: 20px; font-family: 'Consolas', monospace; }
        .output-header { color: #94a3b8; font-size: 0.85rem; margin-bottom: 15px; border-bottom: 1px solid #1e293b; padding-bottom: 10px; }
        pre { margin: 0; white-space: pre-wrap; font-size: 1.05rem; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>ğŸ“š Ù…Ù†ØµØ© Ø¹Ù…Ø§Ø¯ ÙƒØ§Ø¸Ù… Ø§Ù„Ø´Ø§Ù…Ù„Ø©</h1>
        <p>Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø®ÙŠØ±: MARC21 + RDA + Ø§Ù„Ø±Ø¨Ø· Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ø¨Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©</p>
    </div>

    <div class="training-modes">
        <button class="btn-mode" onclick="loadSample('book')">ğŸ“– ÙƒØªØ§Ø¨ Ù…Ø¹ Ø³Ù„Ø³Ù„Ø©</button>
        <button class="btn-mode" onclick="loadSample('thesis')">ğŸ“ Ø£Ø·Ø±ÙˆØ­Ø© Ø¹Ù„Ù…ÙŠØ©</button>
        <button class="btn-mode" onclick="loadSample('electronic')">ğŸŒ Ù…ÙˆØ±Ø¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</button>
        <button class="btn-mode btn-clear" onclick="clearForm()">ğŸ§¹ Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
    </div>

    <form id="marcForm">
        <div class="marc-grid">
            
            <!-- Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ØªÙ‚Ù†ÙŠÙ† -->
            <div class="card">
                <div class="card-title">Ø§Ù„ØªÙ‚Ù†ÙŠÙ† ÙˆØ§Ù„ØªØµÙ†ÙŠÙ <span>(0xx)</span></div>
                <div class="field-row" data-tag="020">
                    <div class="label-box">
                        <label><span class="tag-num">020</span> Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø¹ÙŠØ§Ø±ÙŠ ISBN</label>
                        <a href="https://www.bibalex.org" target="_blank" class="help-link">ØŸ</a>
                    </div>
                    <input placeholder="978...">
                </div>
                <div class="field-row" data-tag="082">
                    <div class="label-box">
                        <label><span class="tag-num">082</span> ØªØµÙ†ÙŠÙ Ø¯ÙŠÙˆÙŠ</label>
                        <a href="https://www.bibalex.org" target="_blank" class="help-link">ØŸ</a>
                    </div>
                    <input placeholder="025.3">
                </div>
            </div>

            <!-- Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© -->
            <div class="card">
                <div class="card-title">Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ÙˆØ§Ù„Ø³Ù„Ø³Ù„Ø© <span>(1xx-4xx)</span></div>
                <div class="field-row" data-tag="100">
                    <div class="label-box">
                        <label><span class="tag-num">100</span> Ø§Ù„Ù…Ø¤Ù„Ù Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</label>
                        <a href="https://www.bibalex.org" target="_blank" class="help-link">ØŸ</a>
                    </div>
                    <input placeholder="Ø§Ù„Ù„Ù‚Ø¨ØŒ Ø§Ù„Ø§Ø³Ù…">
                </div>
                <div class="field-row" data-tag="245">
                    <div class="label-box">
                        <label><span class="tag-num">245</span> Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ©</label>
                        <a href="https://www.bibalex.org" target="_blank" class="help-link">ØŸ</a>
                    </div>
                    <input>
                </div>
                <div class="field-row" data-tag="490">
                    <div class="label-box">
                        <label><span class="tag-num">490</span> Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ù„Ø³Ù„Ø©</label>
                        <a href="https://www.bibalex.org" target="_blank" class="help-link">ØŸ</a>
                    </div>
                    <input placeholder="Ø§Ø³Ù… Ø§Ù„Ø³Ù„Ø³Ù„Ø© Ø› Ø§Ù„Ø±Ù‚Ù…">
                </div>
            </div>

            <!-- Ø§Ù„ÙˆØµÙ Ø§Ù„Ù…Ø§Ø¯ÙŠ RDA -->
            <div class="card">
                <div class="card-title">Ø§Ù„ÙˆØµÙ Ø§Ù„Ù…Ø§Ø¯ÙŠ RDA <span>(3xx)</span></div>
                <div class="field-row" data-tag="300">
                    <div class="label-box">
                        <label><span class="tag-num">300</span> Ø§Ù„ÙˆØµÙ Ø§Ù„Ù…Ø§Ø¯ÙŠ</label>
                        <a href="https://www.bibalex.org" target="_blank" class="help-link">ØŸ</a>
                    </div>
                    <input placeholder="Øµ Ø› Ø³Ù…">
                </div>
                <div class="field-row" data-tag="336">
                    <div class="label-box">
                        <label><span class="tag-num">336</span> Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰</label>
                        <a href="https://www.bibalex.org" target="_blank" class="help-link">ØŸ</a>
                    </div>
                    <input value="Ù†Øµ (text)">
                </div>
                <div class="field-row" data-tag="338">
                    <div class="label-box">
                        <label><span class="tag-num">338</span> Ù†ÙˆØ¹ Ø§Ù„Ù†Ø§Ù‚Ù„</label>
                        <a href="https://www.bibalex.org" target="_blank" class="help-link">ØŸ</a>
                    </div>
                    <input value="Ù…Ø¬Ù„Ø¯ (volume)">
                </div>
            </div>

            <!-- Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª ÙˆØ§Ù„Ø±ÙˆØ§Ø¨Ø· -->
            <div class="card">
                <div class="card-title">Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª ÙˆØ§Ù„ÙˆØµÙˆÙ„ <span>(5xx-8xx)</span></div>
                <div class="field-row" data-tag="500">
                    <div class="label-box">
                        <label><span class="tag-num">500</span> Ù…Ù„Ø§Ø­Ø¸Ø© Ø¹Ø§Ù…Ø©</label>
                        <a href="https://www.bibalex.org" target="_blank" class="help-link">ØŸ</a>
                    </div>
                    <input>
                </div>
                <div class="field-row" data-tag="856">
                    <div class="label-box">
                        <label><span class="tag-num">856</span> Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                        <a href="https://www.bibalex.org" target="_blank" class="help-link">ØŸ</a>
                    </div>
                    <input style="direction: ltr;" placeholder="http://...">
                </div>
            </div>

        </div>
    </form>

    <div class="actions">
        <button onclick="updateDisplay()" class="btn-main" style="background:var(--primary)">ğŸ”„ ØªÙˆÙ„ÙŠØ¯ Ø³Ø¬Ù„ MARC</button>
        <button onclick="exportExcel()" class="btn-main" style="background:var(--success)">ğŸ“Š ØªØµØ¯ÙŠØ± Excel</button>
    </div>

    <div class="output-container">
        <div class="output-header">Ø¹Ø±Ø¶ ØªØ³Ø¬ÙŠÙ„Ø© Ù…Ø§Ø±Ùƒ 21 Ø§Ù„Ù…ØªÙˆÙ„Ø¯Ø©:</div>
        <pre id="marcDisplay">LDR 00000nam a2200000 i 4500</pre>
    </div>
</div>

<script>
    function updateDisplay() {
        let text = "LDR 00000nam a2200000 i 4500\n";
        document.querySelectorAll('.field-row').forEach(row => {
            const tag = row.dataset.tag;
            const val = row.querySelector('input').value;
            if(val) {
                let ind = "##";
                if(tag === "100") ind = "1#";
                if(tag === "245") ind = "10";
                if(tag === "856") ind = "40";
                text += `${tag} ${ind} $a ${val}\n`;
            }
        });
        document.getElementById('marcDisplay').innerText = text;
    }

    function clearForm() {
        document.querySelectorAll('input').forEach(i => {
            if(!["336","338"].includes(i.closest('.field-row').dataset.tag)) i.value = '';
        });
        updateDisplay();
    }

    function loadSample(type) {
        clearForm();
        const samples = {
            book: {"020":"978-9921-712-00-1", "100":"ÙƒØ§Ø¸Ù…ØŒ Ø¹Ù…Ø§Ø¯", "245":"Ø¯Ù„ÙŠÙ„ Ù…Ø§Ø±Ùƒ Ø§Ù„Ø¹Ø±Ø¨ÙŠ", "490":"Ø³Ù„Ø³Ù„Ø© Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø› 5", "300":"150 Øµ"},
            thesis: {"100":"Ø£Ø­Ù…Ø¯ØŒ Ø¹Ù„ÙŠ", "245":"Ø£Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª", "502":"Ø±Ø³Ø§Ù„Ø© Ù…Ø§Ø¬Ø³ØªÙŠØ±", "856":"http://uni.edu"},
            electronic: {"245":"Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù…Ø¹Ø±ÙØ©", "338":"Ù…ÙˆØ±Ø¯ Ø¹Ø¨Ø± Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª", "856":"http://info.com"}
        };
        const data = samples[type];
        Object.keys(data).forEach(tag => {
            const el = document.querySelector(`[data-tag="${tag}"] input`);
            if(el) el.value = data[tag];
        });
        updateDisplay();
    }

    function exportExcel() {
        let rows = [["Tag", "Data"]];
        document.querySelectorAll('.field-row').forEach(row => {
            const val = row.querySelector('input').value;
            if(val) rows.push([row.dataset.tag, val]);
        });
        const ws = XLSX.utils.aoa_to_sheet(rows);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "MARC");
        XLSX.writeFile(wb, "Emad_Kazem_Record.xlsx");
    }
</script>
</body>
</html>
